:root{--accent:#0039BA;--text:#111;--muted:#6b7280;--line:#e5e7eb;--bg:#fff;--hdr-a:#0B5FA8;--hdr-b:#108CBC;--hdr-c:#49C3B6;--prog-a:#ef7d00;--prog-b:#F7A600;--queue-height:520px}
    *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--text);font:14px/1.4 ui-sans-serif,system-ui,Segoe UI,Roboto}
    header{position:sticky;top:0;z-index:10;background:linear-gradient(90deg,var(--hdr-a),var(--hdr-b),var(--hdr-c));color:#fff}
    .top{display:flex;align-items:center;justify-content:center;padding:12px 16px;position:relative}
    .top h1{margin:0;font-size:18px;font-weight:800;letter-spacing:.5px}
    .top .icons{position:absolute;right:12px;display:flex;gap:12px}
    .icon{width:22px;height:22px;display:inline-flex;align-items:center;justify-content:center;border-radius:8px;background:rgba(255,255,255,.12);cursor:pointer}
    main{max-width:1100px;margin:18px auto;padding:0 14px}
    .card{background:#fff;border:1px solid var(--line);border-radius:14px;box-shadow:0 8px 20px rgba(0,0,0,.06)}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
    .tabs{display:flex;border-bottom:1px solid var(--line)}
    .tab{padding:12px 16px;cursor:pointer;font-weight:600;font-size:15px;border-bottom:2px solid transparent}
    .tab.active{color:var(--accent);border-bottom-color:var(--accent)}
    .content{padding:16px}
    .controls{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
    .progress-row{display:flex;flex-direction:column;align-items:flex-start;gap:6px;margin-top:8px;width:100%}
    button{appearance:none;border:1px solid var(--line);background:#fff;color:var(--text);padding:9px 14px;border-radius:10px;cursor:pointer;font-weight:700}
    select{border:1px solid var(--line);background:#fff;color:var(--text);padding:8px 12px;border-radius:10px;font-weight:600;min-width:160px}
    select:focus{outline:2px solid rgba(16,140,188,.25);outline-offset:1px}
    #btnIniciar,#btnContinuar,#btnTratamentoIniciar,#btnTratamentoContinuar{padding:9px 14px;font-size:14px;border-radius:10px}
    button.primary{border:0;color:#fff;background:#108CBC;box-shadow:none;transition:transform .15s ease,background-color .15s ease}
    button.primary:hover:not(:disabled){background:#0b749f;transform:translateY(-1px)}
    #btnContinuar:not(.primary),#btnTratamentoContinuar:not(.primary){background:#f3f4f6;color:var(--muted);border-color:#d1d5db}
    button:disabled{opacity:.5;cursor:not-allowed}
    .muted{color:var(--muted);font-size:12px}
    .row{display:flex;gap:14px;flex-wrap:wrap;align-items:center}
    .progress{height:10px;background:#f3f4f6;border:1px solid var(--line);border-radius:999px;overflow:hidden;width:100%;min-width:220px;flex:1 1 auto}
    .progress>div{height:100%;background:linear-gradient(90deg,var(--prog-a),var(--prog-b));position:relative;transition:width .2s ease}
    table{width:100%;border-collapse:collapse} th,td{padding:10px;border-bottom:1px solid var(--line)}
    th{text-align:left;font-size:12px;color:#4b5563;font-weight:700;letter-spacing:.3px}
    .right{text-align:right}
    th.filterable{position:relative}
    .th-filter{display:inline-flex;align-items:center;gap:6px;cursor:pointer;user-select:none}
    .th-filter.no-toggle{cursor:default}
    .th-filter-label{display:flex;flex-direction:column;line-height:1}
    .filter-toggle{border:0;background:transparent;width:22px;height:22px;border-radius:6px;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;padding:0;transition:background-color .2s ease}
    .th-filter:hover .filter-toggle,.filter-toggle:focus-visible{background:rgba(16,140,188,.12);outline:none}
    .filter-toggle svg{width:12px;height:12px;stroke:#4b5563;stroke-width:2;fill:none;transition:transform .2s ease}
    .filter-toggle.open svg{transform:rotate(180deg)}
    .filter-menu{position:fixed;top:auto;left:auto;min-width:160px;background:#fff;border:1px solid var(--line);border-radius:10px;box-shadow:0 14px 32px rgba(15,23,42,.18);padding:6px;display:none;z-index:200}
    .filter-menu.open{display:block}
    .filter-option{display:flex;width:100%;padding:8px 10px;border:0;background:transparent;font-weight:600;color:var(--text);border-radius:8px;cursor:pointer;text-align:left}
    .filter-option:hover,.filter-option:focus-visible{background:rgba(16,140,188,.12);outline:none}
    .filter-option.active{color:var(--accent);background:rgba(16,140,188,.08)}
    /* grid vira 1 coluna */
    .grid{display:grid;grid-template-columns:1fr;gap:16px;align-items:stretch}
    @media (max-width:980px){.grid{grid-template-columns:1fr}}
    .grid > div{display:flex;flex-direction:column;min-height:0}
    /* Card de logs */
    .logs-card{margin-top:16px;border-radius:14px;border:1px solid var(--line);overflow:hidden}
    .logs-header{
      display:flex;align-items:center;justify-content:space-between;
      padding:10px 12px;background:#fff;cursor:pointer;user-select:none;
      border-bottom:1px solid var(--line)
    }
    .logs-header:focus{outline:2px solid rgba(16,140,188,.25);outline-offset:2px}
    .logs-title{display:flex;align-items:center;gap:8px;font-weight:800;color:var(--text)}
    .logs-title .caret{display:inline-block;transition:transform .18s ease;transform-origin:center}
    .logs-header[aria-expanded="true"] .caret{transform:rotate(90deg)}

    .logs-actions{display:flex;gap:8px;align-items:center;}
    .logs-actions input[type="date"]{
      padding:6px 8px;border:1px solid var(--line);border-radius:8px;font:inherit
    }
    .btn-export{
      appearance:none;border:0;background:#108CBC;color:#fff;font-weight:700;
      padding:8px 12px;border-radius:10px;cursor:pointer
    }
    .btn-export:hover{background:#0b749f}
    .btn-export:disabled{opacity:.5;cursor:not-allowed}

    .logs-body{background:#fff}
    .logs-table-wrap{
      /* Altura fixa no abrir + rolagem interna */
      height:300px;overflow:auto;padding:10px 12px;
    }
    .logs-table{width:100%;border-collapse:collapse}
    .logs-table th,.logs-table td{padding:8px 10px;border-bottom:1px solid var(--line);font-size:13px}
    .logs-table th{text-align:left;font-size:12px;color:#4b5563;font-weight:700;letter-spacing:.3px}

    /* badges por status */
    .badge-status{
      display:inline-block;padding:2px 8px;border-radius:999px;font-weight:800;font-size:11px;
      border:1px solid transparent
    }
    .badge-status.sucesso{background:#ecfdf5;color:#065f46;border-color:#a7f3d0}
    .badge-status.falha{background:#fef2f2;color:#991b1b;border-color:#fecaca}
    .badge-status.descartado{background:#fffbeb;color:#92400e;border-color:#fde68a}
    .badge-status.pausado{background:#e0f2fe;color:#0c4a6e;border-color:#7dd3fc}

    .logs-footer{padding:8px 12px 12px}
    .footer{display:flex;justify-content:space-between;align-items:center;margin-top:8px}
    .page-footer{margin:48px auto 24px;text-align:center;font-size:12px;color:var(--muted);line-height:1.6}
    .page-footer p{margin:0}
    .state{font-weight:700}
    /* sub-abas dentro da seção */
    .subtabs{display:flex;gap:14px;align-items:center;margin:12px 0 6px}
    .subtab{font-weight:700;opacity:.6;cursor:pointer}
    .subtab.active{color:var(--accent);opacity:1}
    .badge{display:inline-block;min-width:18px;padding:0 6px;border-radius:999px;background:#fef2f2;color:#b91c1c;font-weight:800;font-size:11px;border:1px solid #fecaca;vertical-align:middle;margin-left:6px}
    /* link copyable */
    .copy{color:#0b5fa8;cursor:pointer;text-decoration:underline;position:relative;display:inline-block}
    .copy.copied{color:#16a34a;text-decoration:none}
    .copy.copied::after{content:"item copiado";position:absolute;left:50%;top:-32px;transform:translateX(-50%);background:rgba(17,17,17,.92);color:#fff;font-size:11px;font-weight:600;padding:4px 8px;border-radius:6px;white-space:nowrap;box-shadow:0 4px 10px rgba(0,0,0,.18);pointer-events:none;animation:copy-tooltip .9s ease;z-index:20}
    .copy.copied::before{content:"";position:absolute;left:50%;top:-10px;transform:translateX(-50%);border:6px solid transparent;border-top-color:rgba(17,17,17,.92);pointer-events:none;animation:copy-tooltip-arrow .9s ease;z-index:19}
    @keyframes copy-tooltip{0%{opacity:0;transform:translate(-50%,-4px)}20%{opacity:1;transform:translate(-50%,-10px)}80%{opacity:1;transform:translate(-50%,-12px)}100%{opacity:0;transform:translate(-50%,-14px)}}
    @keyframes copy-tooltip-arrow{0%{opacity:0;transform:translate(-50%,2px)}20%{opacity:1;transform:translate(-50%,0)}80%{opacity:1;transform:translate(-50%,-1px)}100%{opacity:0;transform:translate(-50%,-2px)}}
    .modal-backdrop{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.35);z-index:50;padding:16px}
    .modal-backdrop.active{display:flex}
    .modal-window{background:#f7f7f7;border:1px solid rgba(17,24,39,.18);box-shadow:0 18px 36px rgba(15,23,42,.28);max-width:320px;min-width:260px;width:100%;font-family:inherit;outline:none}
    .modal-window[role="document"]:focus{outline:2px solid rgba(16,140,188,.4);outline-offset:-4px}
    .modal-titlebar{display:flex;align-items:center;justify-content:space-between;background:linear-gradient(90deg,var(--hdr-a),var(--hdr-b),var(--hdr-c));color:#fff;padding:6px 10px;font-size:13px;font-weight:600;letter-spacing:.2px}
    .modal-titlebar .modal-title{margin:0;min-height:1em}
    .modal-window button{font-family:inherit;font-weight:600;border-radius:0;background:#fff;border:1px solid rgba(17,24,39,.18);box-shadow:none;cursor:pointer;transition:none;color:#111;padding:6px 12px}
    .modal-window button:focus-visible{outline:2px solid rgba(16,140,188,.4);outline-offset:2px}
    .modal-window button:active{background:#f3f4f6}
    .modal-close{margin-left:12px;min-width:auto;width:22px;height:22px;padding:0;line-height:1;font-size:12px;display:inline-flex;align-items:center;justify-content:center}
    .modal-body{padding:24px 20px;background:#f7f7f7}
    .modal-body p{margin:0;font-size:14px;font-weight:400;color:#000}
    .modal-actions{display:flex;justify-content:center;padding:0 20px 18px;background:#f7f7f7}
    .modal-actions .modal-button{min-width:96px;font-size:13px}

    /* Tratamentos */
    .treatment-controls{display:flex;align-items:center;gap:16px;flex-wrap:wrap;margin-bottom:14px}
    .treatment-buttons{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
    .treatment-buttons .muted{margin-left:4px}
    .treatment-export{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
    .treatment-export input[type="date"]{padding:6px 10px;border:1px solid var(--line);border-radius:8px;font:inherit}
    .treatment-grid{display:flex;flex-direction:column;gap:16px}
    .treatment-column{background:#fff;border:1px solid var(--line);border-radius:12px;padding:14px;display:flex;flex-direction:column;gap:10px;min-height:0}
    #treatmentQueueTable{width:100%;border-collapse:collapse}
    #treatmentQueueTable th,#treatmentQueueTable td{padding:8px 10px;border-bottom:1px solid var(--line);font-size:13px;text-align:left}
    #treatmentQueueTable th{font-size:12px;color:#4b5563;font-weight:700;letter-spacing:.3px}
    #treatmentQueueTable tbody tr:last-child td{border-bottom:0}
    .queue-column{height:auto}
    .queue-column .treatment-queue-scroll{flex:0 1 auto;max-height:240px;overflow:auto;padding-right:4px;scrollbar-width:thin;scrollbar-color:rgba(17,24,39,.35) transparent}
    .queue-column .treatment-queue-scroll table{margin-bottom:0}
    .queue-column .treatment-queue-scroll::-webkit-scrollbar{width:8px}
    .queue-column .treatment-queue-scroll::-webkit-scrollbar-thumb{background:rgba(17,24,39,.25);border-radius:999px}
    .queue-column .treatment-queue-scroll:hover::-webkit-scrollbar-thumb{background:rgba(17,24,39,.35)}
    .queue-row.current{background:rgba(16,140,188,.08)}
    .queue-row.rescindido{background:#ecfdf5}
    .queue-row.descartado{background:#fef2f2}
    .queue-badge{display:inline-block;padding:2px 8px;border-radius:999px;font-size:11px;font-weight:700;background:#f3f4f6;color:#111;text-transform:uppercase}
    .treatment-empty{font-size:13px;color:var(--muted)}
    .treatment-card-header{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
    .treatment-card-header h3{margin:0}
    .table-search-input{
      min-width:260px;
      flex:1 1 420px;
      width:100%;
      max-width:560px;
      padding:8px 12px;
      border:1px solid var(--line);
      border-radius:10px;
      font:inherit
    }
    .table-search-input:focus{outline:2px solid rgba(16,140,188,.25);outline-offset:1px}
    .treatment-table-scroll{overflow:auto}
    .treatment-table-footer{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;margin-top:8px}
    .treatment-logs{margin-top:20px}
    .treatment-logs .logs-actions{flex-wrap:wrap;justify-content:flex-end}
    .btn-link{appearance:none;border:1px solid var(--line);background:#fff;border-radius:8px;padding:6px 10px;font-weight:600;cursor:pointer}
    .btn-link:hover{background:rgba(16,140,188,.08)}
