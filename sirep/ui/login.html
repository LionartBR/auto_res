<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <title>SIREP 2.0 — Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link rel="stylesheet" href="css/styles.css" />
</head>
<body class="login-screen">
  <main class="login-screen__content" aria-labelledby="loginTitle">
    <form id="loginForm" class="login-card" data-redirect="index.html" novalidate>
      <h2 id="loginTitle">SIREP 2.0</h2>
      <p class="login-description">Acesse com a sua matrícula e senha institucional.</p>
      <div class="login-field">
        <label for="loginUser">Matrícula</label>
        <input
          type="text"
          id="loginUser"
          name="username"
          autocomplete="username"
          placeholder="C123456"
          required
        />
      </div>
      <div class="login-field">
        <label for="loginPassword">Senha</label>
        <input
          type="password"
          id="loginPassword"
          name="password"
          class="with-icon"
          autocomplete="current-password"
          placeholder="Digite sua senha"
          required
        />
      </div>
      <p id="loginError" class="login-error" role="alert" aria-live="assertive" hidden></p>
      <div class="login-actions">
        <button type="submit" id="loginSubmit" class="primary login-submit">Entrar</button>
      </div>
      <footer class="login-footer" aria-label="Informações institucionais">
        <p>CEFGD/RJ – Recuperação de Débitos do FGTS Perante o Empregador</p>
      </footer>
    </form>
  </main>

  <script src="js/utils.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/login.js"></script>
  <script>
    /*
    window.addEventListener('DOMContentLoaded', function () {
      if (window.SirepLogin && typeof window.SirepLogin.init === 'function') {
        var redirectTarget = 'index.html';

        try {
          var params = new URLSearchParams(window.location.search || '');
          var nextParam = params.get('next');
          if (nextParam) {
            var candidate = String(nextParam).trim();
            var hasProtocol = /^[a-z][a-z0-9+.-]*:/i.test(candidate) || candidate.startsWith('//');
            var hasTraversal = candidate.startsWith('..');
            if (candidate && !hasProtocol && !hasTraversal) {
              redirectTarget = candidate;
            }
          }
        } catch (error) {
          console.warn('Não foi possível interpretar o destino pós-login.', error);
        }

        window.SirepLogin.init({
          redirectTo: redirectTarget,
        });
      }
    });
    */
  </script>
</body>
</html>
